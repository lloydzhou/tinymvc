<?php class userController {	function initTable(){		$db = ORM::get_db();		$db->exec("			CREATE TABLE IF NOT EXISTS `user` (				id INTEGER PRIMARY KEY, 				name TEXT,				password TEXT,				email TEXT,				salt TEXT			);"		);		redirect('/user/index');	}	function index() {	    $count = User::for_table('user')->count();		$user_list = User::for_table('user')->find_many();		render('user/index', array('count' => $count, 'user_list' => $user_list), 'layout');	}	function create() {		if (!empty($_POST)) {			if (User::for_table('user')->create(array('name' => params('name'), 'email' => params('email')))->save())				redirect('/user/index');		}		render('user/create', null, 'layout');	}	function update() {		$user = $this->_getUser();		if (!empty($_POST)) {			$user->name = params('name');			$user->email = params('email');			if ($user->save())				redirect('/user/view/id/'. $user->id);		}		render('user/update', array('user' => $user), 'layout');	}	public function delete() {		$user = $this->_getUser();		if ($user->delete())			render('user/delete', array('message' => "Delete User #{$user->id} SUCCESS."));		else render('user/delete', array('message' => "Fail to delete User #{$user->id}."));	}	function view() {		$user = $this->_getUser();		render('user/view', array('user' => $user), 'layout');	}	protected function _getUser() {		if (!($id = params('id')))			error(404, 'Bad Request.');		$user = User::for_table('user')->find_one($id);		if (!$user)			error(404, 'Record not found.');		return $user;	}}